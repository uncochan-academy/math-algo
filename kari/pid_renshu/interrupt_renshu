//最適化で情報が消えるのを防ぐためにvolatileを使う
//例えばif (counter < 1)の判定が必ず真になってしまう
//なぜなら基本のloopの中にcounterを変えるコードがないから
volatile int counter = 0;

//unsigned:符号なし long:32bit
volatile unsigned long lastTime = 0;

//初期化開始
void setup() {
  //シリアル通信開始．1秒間に9600ビット送る
  Serial.begin(9600);
  //ピン２を入力モードにしてプルアップ抵抗を有効にする
  //抵抗をつけるとショートしなくなったり信号が安定したりする
  pinMode(2, INPUT_PULLUP);
  pinMode(3, INPUT_PULLUP);
  //割り込み処理の設定
  attachInterrupt(
    //ピン2の割り込み番号を取得
    digitalPinToInterrupt(2),
    //実行する関数
    countUp,
    //トリガー条件high->lowになったとき割り込み
    FALLING
  );
  attachInterrupt(
    digitalPinToInterrupt(3),
    clear,
    FALLING
  );
  Serial.println("開始");
}

//ループ開始
void loop() {
  Serial.println(counter);
  delay(1000);
}

//割り込みする関数
void countUp() {
  unsigned long now = millis();
  //前回おした時間とのあいだが50みり秒以下なら入力を無視する
  if(now - lastTime > 100) {
    counter++;
    lastTime = now;
  }
}

void clear() {
  Serial.println("クリアー");
  counter = 0;
}